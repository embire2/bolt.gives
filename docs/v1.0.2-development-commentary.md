# v1.0.2: Development Commentary (Codex-Style Feedback)

## Goal

Make bolt.gives feel "alive" while it works.

Instead of silently emitting artifacts/actions and then dumping results at the end, the assistant should stream frequent, short progress updates (commentary) while it plans, edits files, runs commands, and iterates.

## Requirements

- The AI must provide incremental progress updates while it works.
- bolt.gives must reliably distinguish:
  - Commentary (user-facing narrative)
  - Code/actions (file edits, commands, tool calls)
- Commentary must be displayed in the appropriate UI space (chat stream), while code/actions continue to be routed to the workbench.

## Proposed Output Contract

1. All code changes remain inside `<boltAction type="file">` blocks (existing contract).
2. Commentary is plain Markdown outside `<boltArtifact>` blocks.
3. Commentary is short and frequent:
   - 1-2 sentences before a major action (what/why)
   - 1 sentence after each result (what happened/next)

This is already compatible with how the app works today:
- The runtime parser strips `<boltArtifact>/<boltAction>` blocks into the workbench.
- Remaining text is shown in chat, so it naturally becomes "commentary".

## Implementation Plan

### 1) Prompting (server)

Where:
- `app/lib/.server/llm/stream-text.ts`

What:
- Append a `<workstyle>` section to the system prompt (build mode and discuss mode).
- Emphasize:
  - frequent progress updates
  - no code outside actions
  - no commands/file contents inside commentary

### 2) UI (optional improvement)

Phase 1:
- Display commentary in the normal assistant chat bubble (already happens once the model emits text outside artifacts).

Phase 2 (nice-to-have):
- Support an explicit commentary channel using a wrapper tag (example: `<commentary>...</commentary>`).
- Parse it in the streaming parser and render in a dedicated "progress" sub-panel, distinct from final answer.

### 3) Tests

Add regression tests to prevent silent behavior:
- Unit: confirm that prompting includes the workstyle block.
- Unit: confirm the message parser strips artifacts/actions but retains commentary text.
- E2E smoke (one provider): confirm that during a build flow the assistant emits commentary before/after actions.

## Non-Goals (v1.0.2)

- Full "terminal-like" streaming transcript cloning Codex CLI exactly.
- Replacing workbench action routing.

