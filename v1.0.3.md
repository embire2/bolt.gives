# v1.0.3 Roadmap: Commentary-First Agent Experience

Date: 2026-02-20
Status: Completed

## Goal
Make Bolt.gives the most transparent coding agent experience: users should always see what the agent is doing, why it is doing it, and what happened next.

This release is focused on beating the best current UX patterns (Replit, Loveable, Bolt.new) in:
- Live commentary quality
- Execution transparency
- Recovery clarity
- Trust and auditability

## Core Product Outcomes

- [x] Commentary appears fast and continuously during runs
- [x] Commentary is visually and structurally distinct from code/actions
- [x] Runs expose clear phase transitions (Plan -> Doing -> Verifying -> Next)
- [x] Users can inspect exact action history and outcomes without ambiguity
- [x] Failures are explicit, actionable, and never falsely reported as success

## v1.0.3 Scope

### P0.1 Commentary Cards + Phase Model
- [x] Add normalized commentary event types and phase metadata.
- [x] Render commentary as dedicated cards separate from tool/action rows.
- [x] Show phase badges and clear transitions:
  - Plan
  - Doing
  - Verifying
  - Next

### P0.2 Enforced Commentary Format Contract
- [x] Add server-side prompt contract for concise live updates:
  - short micro-updates during execution
  - periodic numbered `Key changes:` summaries
  - one explicit `Next:` line
- [x] Add regression tests for formatting contract output.

### P0.3 Sticky Working Footer
- [x] Add always-visible execution footer with:
  - active model + provider
  - current phase and step number
  - elapsed run time
  - action count
  - recovery status (if active)
- [x] Ensure footer updates without requiring scroll.

### P0.4 First-Class Checkpoint Events
- [x] Surface checkpoint events directly in timeline:
  - checkpoint created
  - dependency install complete
  - preview ready
  - tests passed/failed
  - deployment started/completed
- [x] Link checkpoint events to relevant files/actions where possible.

### P0.5 Honesty Guardrails (No Hidden/Optimistic Success)
- [x] Prevent “success” narration unless command/action exit status confirms success.
- [x] Always include failure context:
  - failed command
  - exit code
  - stderr snippet
  - next recovery attempt or user action
- [x] Add tests for false-positive completion prevention.

### P0.6 Long-Run Performance De-bloat (Server-First Execution)
- [x] Remove/disable heavy client-side work that causes slowdown on long projects.
- [x] Move heavy tasks to server-side execution paths where possible:
  - large file scans/indexing
  - repo summarization/snapshotting
  - documentation ingestion/parsing
  - long-running validation and build orchestration
- [x] Keep UI responsive under long sessions by:
  - virtualizing large lists/feeds
  - lazy-loading non-critical panels/features
  - reducing retained in-memory timeline/render payloads
- [x] Add runtime telemetry for:
  - main-thread stall duration
  - timeline render cost
  - client memory growth during long runs

### P0.7 Enforced Node Memory Baseline (Install + Upgrade)
- [x] Require Node runtime memory floor of at least 4096 MB for supported install paths.
- [x] Ensure fresh installs and upgrades auto-apply memory defaults (no manual tuning required).
- [x] Add install/upgrade preflight checks that verify `NODE_OPTIONS` includes `--max-old-space-size=4096` (or higher).
- [x] Update installation docs and upgrade docs to reflect enforced baseline.

### P0.8 Git-Backed Auto-Update + One-Click Upgrade
- [x] Add update monitor that checks remote Git version/tag on an interval and on app start.
- [x] Display in-app update notice when a newer version is available.
- [x] Provide one-click update flow that performs:
  - fetch latest
  - fast-forward/update to target version
  - dependency install
  - build/restart
- [x] Include safe failure handling:
  - clear progress + logs
  - rollback/retry path if update fails
  - success confirmation with running version

### P0.9 Architect Self-Heal + Safety Guard
- [x] Ship Architect diagnosis + auto-heal scaffolding for known failure signatures.
- [x] Expand Architect knowledgebase to cover top build/runtime/package-manager failures.
- [x] Ensure Architect auto-heal is mode-aware and obeys safety/autonomy policy.
- [x] Add structured recovery timeline events for Architect diagnosis, repair attempt, and outcome.

### P0.10 Cost Estimation Accuracy Across Providers
- [x] Normalize usage field mappings across provider responses.
- [x] Ensure non-zero, accurate cost estimates in timeline/footer whenever usage exists.
- [x] Add regression tests for usage normalization and cost calculation paths.
- [x] Add E2E validation for strict + standard providers.

### P0.11 Provider/Model/API Key Session Persistence
- [x] Persist latest working API key/provider/model per instance.
- [x] Auto-restore latest working selection on revisit.
- [x] Keep provider history navigable so users can switch back to previously working providers.
- [x] Add tests for persistence/restore and default-selection replacement rules.

## P1 (Stretch in v1.0.3, otherwise v1.0.4 carry-over)

- [ ] Commentary density tuning by autonomy mode.
- [ ] Expand/collapse controls for verbose vs concise updates.
- [ ] Save commentary transcript in exports with structured phases.

## Acceptance Criteria

1. Commentary first event appears within 2 seconds of run start.
2. During active runs, a meaningful commentary update appears at least every 10 seconds.
3. Every major tool/shell action has “why this action” + observed outcome.
4. Failure states include command, exit code, and next recovery step.
5. Execution footer remains visible and accurate while user scrolls.
6. No run may emit a final success statement if any critical action failed.
7. Long-running project sessions remain responsive with no severe client-side stalls.
8. Fresh install and upgrade both enforce Node memory baseline >= 4096 MB.
9. Users receive update notifications and can complete an update with one click.
10. Architect auto-heals known high-frequency failures and reports recovery attempts in timeline.
11. API key/provider/model selections persist and restore reliably across revisits.
12. Cost estimate is non-zero when usage exists and remains consistent with provider usage data.

## Test Plan

- [x] Unit tests for commentary phase/event mapping and formatting contract.
- [x] Unit tests for success/failure narration guardrails.
- [x] Integration test for timeline rendering separation (commentary vs actions).
- [x] E2E smoke on `https://alpha1.bolt.gives` with OpenAI `gpt-5-codex` (strict path).
- [x] E2E smoke on `https://alpha1.bolt.gives` with OpenAI `gpt-4o` (standard path).
- [x] Performance de-bloat guardrails validated via timeline retention + virtualization checks.
- [~] Install/upgrade integration test validating enforced Node memory floor (script preflight + update API enforcement verified).
- [ ] E2E update test: detect new version, show banner, apply one-click update, verify version bump.
- [x] Unit/integration tests for Architect diagnosis routing and auto-heal gating by autonomy mode.
- [x] E2E verification of persisted provider/model/key selection and non-zero cost estimation.

## Release Checklist

- [x] `pnpm run typecheck`
- [x] `pnpm run lint`
- [x] `pnpm test`
- [x] targeted E2E pass on alpha1
- [x] update `CHANGELOG.md`
- [x] update `README.md` (if user-facing behavior changed)
- [x] mark completed items in this file with release references

### Release References

- Runtime/UI: `app/components/chat/StepRunnerFeed.tsx`, `app/components/chat/ExecutionStickyFooter.tsx`, `app/components/chat/ExecutionTransparencyPanel.tsx`
- Commentary contract: `app/lib/runtime/commentary-contract.ts`, `app/routes/api.chat.ts`
- Architect recovery: `app/lib/runtime/architect.ts`, `app/lib/runtime/architect.spec.ts`, `app/components/chat/Chat.client.tsx`
- Provider persistence/history: `app/lib/runtime/model-selection.ts`, `app/components/chat/ModelSelector.tsx`
- Validation: `pnpm run typecheck`, `pnpm run lint`, `pnpm test`, alpha1 E2E smoke (`gpt-5-codex`, `gpt-4o`)

## v1.0.4 Seed Work (Next Release)

Planned direction for private client-hosted instances + Teams collaboration:

- [ ] Instance bootstrap package (client-isolated deployment)
- [ ] Per-instance secrets/config isolation
- [ ] Team RBAC + shared project collaboration
- [ ] Audit logs for agent actions per user/workspace
- [ ] Private networking and storage guidance for enterprise installs
